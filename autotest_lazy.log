spawn make qemu
riscv64-unknown-elf-gcc -Wall -Werror -Wno-unknown-attributes -O -fno-omit-frame-pointer -ggdb -gdwarf-2 -MD -mcmodel=medany -ffreestanding -fno-common -nostdlib -fno-builtin-strncpy -fno-builtin-strncmp -fno-builtin-strlen -fno-builtin-memset -fno-builtin-memmove -fno-builtin-memcmp -fno-builtin-log -fno-builtin-bzero -fno-builtin-strchr -fno-builtin-exit -fno-builtin-malloc -fno-builtin-putc -fno-builtin-free -fno-builtin-memcpy -Wno-main -fno-builtin-printf -fno-builtin-fprintf -fno-builtin-vprintf -I. -fno-stack-protector -fno-pie -no-pie   -c -o user/test_ckpt_lazy.o user/test_ckpt_lazy.c
riscv64-unknown-elf-ld -z max-page-size=4096 -T user/user.ld -o user/_test_ckpt_lazy user/test_ckpt_lazy.o user/ulib.o user/usys.o user/printf.o user/umalloc.o
riscv64-unknown-elf-objdump -S user/_test_ckpt_lazy > user/test_ckpt_lazy.asm
riscv64-unknown-elf-objdump -t user/_test_ckpt_lazy | sed '1,/SYMBOL TABLE/d; s/ .* / /; /^$/d' > user/test_ckpt_lazy.sym
mkfs/mkfs fs.img README user/_cat user/_echo user/_forktest user/_grep user/_init user/_kill user/_ln user/_ls user/_mkdir user/_rm user/_sh user/_stressfs user/_usertests user/_grind user/_wc user/_zombie user/_logstress user/_forphan user/_dorphan user/_hello user/_ps user/_checkpointtest user/_restoretest user/_chkpt user/_restart user/_victim user/_test_ckpt_auto user/_test_ckpt_lazy 
nmeta 47 (boot, super, log blocks 31, inode blocks 13, bitmap blocks 1) blocks 1953 total 2000
balloc: first 1253 blocks have been allocated
balloc: write bitmap block at sector 46
qemu-system-riscv64 -machine virt -bios none -kernel kernel/kernel -m 128M -smp 3 -nographic -global virtio-mmio.force-legacy=false -drive file=fs.img,if=none,format=raw,id=x0 -device virtio-blk-device,drive=x0,bus=virtio-mmio-bus.0

xv6 kernel is booting

hart 1 starting
hart 2 starting
init: starting sh
$ test_ckpt_lazy
=== BEFORE CHECKPOINT ===
TEST: allocated 10 pages (untouched)
TEST: PID=3
chkpt 3 snap_lazy.dat
kill 3
restart snap_lazy.dat

=== AFTER RESTART ===